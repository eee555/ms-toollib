## evfs：一款开源的多扫雷录像格式

* 本规范全文和历史版本均开源在：https://github.com/eee555/ms_toollib/blob/main/evfs%E6%A0%87%E5%87%86.md
* 假如各语言版本内容发生冲突，以中文版为准。

### ​​1.1 目的与目标​​

evfs（eee555's minesweeper video format set）是一种记录了多个扫雷录像的文件格式，包括了成功、失败、重开的所有录像，也包括每局之间的鼠标动作。

evfs格式不是简单的将多个录像集合在一起，而是旨在​​记录一段时间内连续、先后产生的多个的扫雷录像数据，并提供校验码证明，解决兼容性、可交互性等核心问题。并有助于计算开率、局数等数据。

### 1.2 名词解释
单元：evfs文件内容的主体是数个“单元”，每个单元中记录一个录像文件及校验相关的数据。

### 1.3 适用范围​
evfs适用的场景：
- 适用于所有需要分析、记录或回放一段时间内连续产生的多个的扫雷录像的扫雷软件、录像工具、分析工具、比赛系统等。
- 适用于evf标准定义的各种扫雷模式，适用于不同雷数、不同尺寸的局面。
- 适用于保存单次打开软件生成的录像，重新打开软件后无法继续保存在同一个evfs文件中。
- 只适用存放单名用户的录像，而不适用于多位用户的多局录像。
- 当前只适用于存放evf录像，但是技术上可以存放其他格式的录像。

### 1.4 交互方式
evfs具备的交互方式：
- 在evfs中查询、遍历evf录像。
- 从evfs中索引、另存evf录像。
- 在扫雷软件未关闭前，在文件末尾追加录像。

evfs不具备的交互方式：
- 将多个evf合并成一个evfs
- 将多个evfs合并成一个evfs
- 在evfs中间插入（而不是最后追加）录像，或者在扫雷软件关闭后追加录像。


### v0.0（元3.2.1即将采用）  
格式说明：  
1. 定长1字节，uint8：版本号。本白皮书所述版本为'\0'。  
2. 定长2字节，uint16：evfs各单元校验码长度。  
3. evf录像数据(循环结构)：  
    > 以'\0'结尾字符串、'utf-8'编码：evf录像文件名。
    > 定长4字节，uint32：evf录像完整数据块大小，单位为字节。  
    > 变长数据块：evf录像数据块。  
    > 变长数据块：单元效验码。  

